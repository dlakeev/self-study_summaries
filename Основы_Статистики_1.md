# Оглавление <a id="0"></a>

1. [Введение](#1)
    1. [Генеральная совокупность и выборка](#1.1)
    2. [Описательная статистика](#1.2)
    3. [Меры центральной тенденции](#1.3)
    4. [Меры изменчивости](#1.4)
    5. [Квартили распределения и график box-plot](#1.5)
    6. [Нормальное распределение](#1.6)
    7. [Z-преобразование](#1.7)
    8. [Центральная предельная теорема](#1.8)
    9. [Доверительные интервалы](#1.9)
    10. [Идея статистического вывода, p-value](#1.10)
2. [Сравнение средних](#2)
    1. [T-распределение](#2.1)
    2. [Сравнение двух средних; Парный t-test; t-критерий Стьюдента](#2.2)
    3. [Проверка распределения на нормальность](#2.3)
    4. [Однофакторый дисперсионный анализ](#2.4)
    5. [Множественные сравнения в ANOVA](#2.5)
    6. [Многофакторный ANOVA](#2.6)
    7. [AB тесты и статистика](#2.7)

___
# 1. Введение <a id="1"></a>
## 1.1 Генеральная совокупность и выборка <a id="1.1"></a>
**_Генеральная совокупность (далее ГС)_** - совокупность всех объектов, относительно которых предполагается делать выводы при изучении некоторой задачи.

**_Репрезентативная выборка_** - это выборка, обладающая свойствами ГС.

Выборки могут быть:

* random
* stratified
* cluster

| Групповая выборка                                                                                                                | Стратифицированная выборка                                                                              |
|----------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------|
| Выборка формируется только из несколько субпопуляций (кластеров)                                                                 | Выборка формируется из всех субпопуляций (страт)                                                        |
| В пределах кластера элементы должны быть разнородны, тогда как поддерживается однородность или схожесть между разными кластерами | В пределах страты элементы должны быть однородны, а между стратами должна быть разнородность (различия) |
| Схема выборки нужна только для кластеров, попавших в выборку                                                                     | Должна быть сформирована полная схема выборки для всех стратифицированных субпопуляций                  |
| Повышает эффективность выборки, уменьшая стоимость                                                                               | Повышает точность                                                                                       |

___
## 1.2 Описательная статистика <a id="1.2"></a>
**_Эмпирические данные_** - данные, полученные опытным путем.

**_Описательная статистика_** - обработка данных, полученных эмпирическим путем и их систематизации, наглядное представление в виде графиков и таблиц.

**_Распределение вероятностей_** - это закон, описывающий область значений случайной величины и вероятность её появления (частоту) в данной области. То есть насколько часто $X$ появляется в данном диапазоне значений.

**_Гистограмма частот_** - ступенчатая функция показывающая насколько часто вероятно появление величины в указанном диапазоне значений.
___
## 1.3 Меры центральной тенденции <a id="1.3"></a>
* **_Мода_** - это значение признака, которое встречается максимально часто. В выборке может быть несколько или одна мода.
* **_Медиана_** - это значение признака, которое делит упорядочное множество попалам. Если множество содержит чётное количество элементов, то берётся среднее из двух серединных элементов упорядочного множества.
* **_Среднее_** - сумма всех значений измеренного признака делится на количество измеренных значений. Свойства:
$$M_{x+c}=M_{x}+c$$
$$M_{x*c}=M_{x}*c$$
$$\sum_{i=1}^{n}(x_{i}-M_{x})=0$$

<p align="center">
  <img src="https://ucarecdn.com/71c5315f-1020-4606-a402-7216a116bae9/">
</p>

___
## 1.4 Меры изменчивости <a id="1.4"></a>
* **_Размах_** - это разность между максимальным и минимальным значениям выборки. Изменение крайних значений очень влияет на результат.
$$R = X_{max}-x_{min}$$
* **_Дисперсия_** - это средний квадрат отклонений индивидуальных значений признака от их средней величины (насколько в среднем значения отклоняются от среднего).
$$D = \frac{\sum_{i=1}^{n}(x_{i}-M_{x})^2}{n}$$
$$D = \frac{\sum_{i=1}^{n}(x_{i}-M_{x})^2}{n-1}$$
Первая формула - для ГС. n - 1 в выборке использутеся для корректировки (связано со степенями свободы).
  _Свойства_:
$$D_{x+c} = D_{x}$$
$$D_{x*c} = D_{x}*c^2$$
* **_Среднеквадратичное отклонение_** - это корень дисперсии. Лучше отражает изменчивость, так как показатель дисперсии завышен из-за квадрата в числителе.
  
  $σ$ - для ГС. $sd$ - для выборки (стандартное отклонение).
  
  _Свойства_:
$$sd_{x+c}=sd_{x}$$
$$sd_{x*c}=sd_{x}*c$$

<p align="center">
  <img src="/img/Меры_изменчивости.png">
</p>

___
## 1.5 Квартили распределения и график box-plot <a id="1.5"></a>
**_Квартили_** - $3$ точки, которые делят упорядоченное множество на $4$ равные части.

**_Box plot_** (ящик с усиками) - удобный вид диаграммы для статистических показателей.

<p align="center">
  <img src="https://ucarecdn.com/c476e686-fb7b-4e8a-b9d3-54d3b461bb44/">
</p>

$Q$ и $IQR$ используют, чтобы оценить наличие выбросов. Алгоритм расчета - посчитать $Q$-ли, разницу между ними, вычислить теоретический максимум и минимум, сравнить с имеющимися и выяснить, есть ли выбросы и сколько их.

<p align="center">
  <img src="https://ucarecdn.com/890a7dfd-5a9b-4a08-b0fc-7e9b15488f78/">
</p>

___
## 1.6 Нормальное распределение <a id="1.6"></a>
* Унимодально
* Симметрично
* Отклонения наблюдений от среднего подчиняются определенному вероятностному закону; равновероятны.

<p align="center">
  <img src="https://raw.githubusercontent.com/KlukvaMors/basic_stat/a3db1e2526a8092d70d988531e8b10ad39ee8f32//img/%D0%B3%D0%B0%D0%BB%D1%8C%D1%82%D0%BE%D0%BD.gif">
</p>

___
## 1.7 Z-преобразование <a id="1.7"></a>
Преобразование полученных данных в стандартную z-шкалу **_со средним значением=0_** и **_дисперсией=1_**.

Чтобы привести к такому виду из каждого наблюдения нужно отнять среднее значение и разделить на стандартное отклонение:
$$Z_{i}=\frac{x_{i} - \bar{X}}{sd}$$
Иногда необходимо расчитать z-значение только для отдельно взятого наблюдения, чтобы выяснить, насколько далеко оно отклоняется от среднего значения в единицах стандартного отклонения.

Такое преобразование никак не влияет на форму распределения.

Чтобы посмотреть, насколько стандартных отклонений отклонилось выборочное среднее от среднего генеральной совокупности используется формула: 
$$Z=\frac{\bar{X}-M}{se}$$

**_Правило сигм в нормальном распределении_**:
* $M_x±σ\approx68$%
* $M_x±2σ\approx95$%
* $M_x±3σ\approx100$%

<p align="center">
  <img src="https://raw.githubusercontent.com/KlukvaMors/basic_stat/a3db1e2526a8092d70d988531e8b10ad39ee8f32//img/3-sigma.svg">
</p>

**Задача №1**
|        Дано:        |               Решение:               |
|:-------------------:|:------------------------------------:|
|   $$\bar{X}=100$$   |           $sd=\sqrt{D}=5$            |
|       $$D=25$$      | $95$% $\approx\bar{X}+2sd={\color{Green}(90, 100)}$ |
|     **Найти:**      |                                      |
| Диапазон $95$% данных |    

**Задача №2**
|      Дано:      |                                          Решение:                                         |
|:---------------:|:-----------------------------------------------------------------------------------------:|
| $$\bar{X}=100$$ |                         $$z_{125}=\frac{x-\bar{X}}{sd}\approx1.7$$                        |
|    $$sd=15$$    | По таблице z-преобразования при $z=1.7$ - $95$% данных лежат слева от искомого значения. |
|    **Найти:**   |                            Значит $(IQ > 125)$% $= 100$%- $95$% = ${\color{Green}5}$%                            |
|   $(IQ > 125)$%  |                                                                                           |

**Задача №3**
|       Дано:      |                         Решение:                        |
|:----------------:|:-------------------------------------------------------:|
|  $$\bar{X}=100$$ |            $z_{70}=-2$ (Слева $2.28$% данных)           |
|     $$sd=15$$    |$z_{112}=0.8$ (Слева $78.81$% данных или справа $21.19$%)|
|    **Найти**:    |              $100- 2.28 -21.19\approx{\color{Green}77}$%               |
|$(70 < IQ < 112)$%|                                                         |

___
## 1.8 Центральная предельная теорема <a id="1.8"></a>
ЦПТ гласит, что множество средних выборок из генеральной совокупности (_ГС необязательно должно иметь нормальное распределение_) будут иметь _нормальное распределение_.

Причем средняя этого распределения будет _близко к средней ГС_, а sd этого распределения будет называться **стандартной ошибкой среднего (se)**.

$$se=\frac{σ}{\sqrt{N}}$$

Если $N$ достаточно большое $(> 30)$ и выборка является репрезентативной, то вместо σ можно взять $sd$.

* Стандартная ошибка среднего - среднеквадратическое отклонение распределения выборочных средних.
* Стандартная ошибка всегда меньше, чем стандартное отклонение при $n > 1$.
* $se$ тем меньше, чем больше $N$ и меньше вариативность исследуемого признака.
* Чем меньше $se$, тем реже выборочные средние будут сильно отклоняться от среднего в ГС.
___
## 1.9 Доверительные интервалы <a id="1.9"></a>
Если мы имеем некоторую выборку и ГС, то мы не можем точно знать среднюю ГС, зная только среднее выборки. Однако мы можем сказать с некоторым процентом уверенности, в каком интервале лежит средняя ГС.

Средняя средних выборок стремится к средней ГС, а se среднего описывает $sd$ распределения средних выборок.

Если взять случайную выборку $X$ и найти $\bar{X}$, вычислить se, то моэно найти доверительный интервал $(DI)$, который описывает среднюю ГС в некотором интервале с $n$% доверия.

* $DI(95)=\left [ \bar{X}\pm1.96*se \right ]$
* $DI(99)=\left [ \bar{X}\pm2.58*se \right ]$

Если рассчитать $95$% $DI$ для среднего значения, то:

* Мы можем быть на $95$% уверены, что $M$ в ГС принадлежит рассчитанному $DI$.
* Если многократно повторять эксперимент, для каждой выборки рассчитывать свой $DI$, то в $95$% случаев истинное среднее будет находиться внутри $DI$.
___
## 1.10 Идея статистического вывода, $p$-value <a id="1.10"></a>
Интерпретация $p$-уровня значимости:
* $p$-уровень значимости ничего не позволяет сказать о том, с какой вероятностью верна нулевая гипотеза $H_0$
* Если $p=0.05$, то это означает, что, если верна $H_0$, вероятность получить такие или еще более выраженные различия, равна $0.05$.
* $p$ не сообщает о силе эффекта, величине различий.
* Если $p>0.05$, то недостаточно оснований, чтобы отклонить $H_0$.
* Чтобы считать значения статистически достоверными, используется двусторонний p-уровень значимости, учитывая отклонения в обе стороны.
* Если отклонять $H_0$ рискованно, то нужно ставить маленький уровень значимости - например, $0.01$.
* $DI$ - альтернатива $p$-value. Если значение $H_0$ не будет принадлежать $DI(95)$, то достаточно оснований отклонить $H_0$. 

**Статистические ошибки:**
Обычно нулевой гепотизой является то что мы хотим опровергнуть - это так называемый _Reject-Support_. Мы как исследователи хотим чтобы нуль-гипотеза был опровергнута  и при этом мы боимся совершить ошибку второго типа (потому что мы упустим возможность что-то исследовать) - поэтому мы будем набирать данные и пробовать таки опровергнуть ее.

А вот общество не хочет чтобы мы совершили ошибку Первого Типа - потому что последующие работы будут основаны на не верных выводах и в будущем все буду разочарованы.

<p align="center">
  <img src="https://ucarecdn.com/7fbb0394-b60e-410d-85ff-2aa0fd2f7e60/">
</p>

**Задача №4**

|        Дано:       |                             Решение:                            |
|:------------------:|:---------------------------------------------------------------:|
|       $M=20$       |                 1) $se=\frac{sd}{\sqrt{N}}=0.5$                 |
|       $N=64$       |                   $z=\frac{\bar{X}-M}{se}=-3$                   |
|   $\bar{X}=18.5$   |             По свойствам нормального распределения:             |
|       $sd=4$       |                   $P(X<-3, X>3)=0.0027<0.05$                  |
|   $H_0:M_{нп}=20$  |     2) $DI(95)=\left [ \bar{X}\pm*se \right ] = \left [ 17.52;19.48 \right ]$   |
| $H_1:M_{нп}\neq20$ | Следовательно, $20$ не принадлежит $DI(95)$ - отклоняем $H_0$  |
|     **Найти**:     |                $100 -2.28 -21.19 \approx{\color{Green}77}$%           |
|         $p$        |                                                                 |
|     $DI(95)$      |                                                                 |
___
# 2. Сравнение средних <a id="2"></a>
## 2.1 T-распределение <a id="2.1"></a>
Если $N$ невелико и $σ$ (почти всегда), используется распределение Стьюдента ($t$-distribution).

T-распределение - унимодально и симметрично, но наблюдения с большей вероятностью попадают за пределы $\pm2σ$ от $M$.

"Форма" распределения определяется **_числом степеней свободы_** $(df=n-1)$. С увеличением $df$ распределение стремится к _нормальному_.
___
## 2.2 Сравнение двух средних; Парный t-test; t-критерий Стьюдента <a id="2.2"></a>
Наиболее часто $t$-критерий применяется для проверки равенства средних значений в двух выборках. $H_0$ предполагает, что средние равны (отрицание этого - гипотеза сдвига).

Для применения данного критерия необходимо, чтобы исходные данные имели нормальное распределение.

$$t=\frac{\bar{X_1}-\bar{X_2}}{se}=\frac{\bar{X_1}-\bar{X_2}}{\sqrt{\frac{sd_{1}^2}{n_1}+\frac{sd_{2}^2}{n_2}}}$$
___
## 2.3 Проверка распределения на нормальность <a id="2.3"></a>
Используется Q-Q Plot

<p align="center">
  <img src="https://ucarecdn.com/8b33fe84-ad8a-4928-87c0-bd0cd1b19492/">
</p>

Для проверки на нормальность используется Shapiro-Wilk test. Менее чувствительной к выбросам Mann-Whitney U-Test (аналог t-критерия).

Выбросы значительно влияют на t-критерий.
___
## 2.4 Однофакторый дисперсионный анализ <a id="2.4"></a>

Переменная, разделяющая на группы - **_независимая_**.

Переменная, по которой идет сравнение - **_зависимая_**.

$t$-критерий и его непараметрические аналоги (например, Mann-Whitney U-test) предназначены для сравнения _исключительно 2 совокупностей_. В случаях $2+$ применяется $F$-test.

* Теоретическое распределение $F$-значения не является нормальным.
* $F$ всегда положительно, поэтому вероятность отклонения рассчитывается только в правую сторону.

$$SS_{total}=SS_{between\_group}+SS_{within_group}$$
$$D = \frac{\sum_{i=1}^{n}(x_{i}-M_{x})^2}{n}$$
$$SS_{between_group}=\sum_{j=1}^{p}n_j(x_{j}-\bar{X})^2$$

___
## 2.5 Множественные сравнения в ANOVA <a id="2.5"></a>
___
## 2.6 Многофакторный ANOVA <a id="2.6"></a>
___
## 2.7 AB тесты и статистика <a id="2.7"></a>
___
[В начало](#0)
